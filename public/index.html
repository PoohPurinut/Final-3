<!DOCTYPE html>
<html>

<head>
  <title>My Form LIFF UPDATED</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

  <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
  <script>
    async function init() {
      try {
        await liff.init({ liffId: "2005447458-w2RMnEr9" });
        if (!liff.isLoggedIn()) {
          liff.login();
        }
        else {
          runApp();
        }
      } catch (error) {
        console.error("Error initializing LIFF: ", error);
        alert("Error initializing LIFF: ", error)
      }
    }

    async function runApp() {

      document.getElementById("myForm").addEventListener("submit", async function (event) {
        event.preventDefault();
        const formData = new FormData(this);
        const data = {};
        formData.forEach((value, key) => {
          data[key] = value;
        });
        const flexMessage = {
          type: "flex",
          altText: "This is a Flex Message",
          contents: {
            type: "bubble",
            direction: "ltr",
            body: {
              type: "box",
              layout: "vertical",
              contents: [
                { type: "text", text: "Name:", weight: "bold" },
                { type: "text", text: data.name },
                // { type: "text", text: "Phone Number:", weight: "bold" },
                // { type: "text", text: data.phoneNumber },          
                { type: "text", text: "Email:", weight: "bold" },
                { type: "text", text: data.email }
                // { type: "text", text: "House Number:", weight: "bold" },
                // { type: "text", text: data.houseNumber }
              ]
            }
          }
        };
        liff.sendMessages([flexMessage]).then(() => {
          alert("Form submitted successfully!");
          liff.closeWindow();
        }).catch((error) => {
          console.error("Error sending message: ", error);
        });
      });
    }

    window.onload = function (e) {
      init();
    };
  </script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
    crossorigin="anonymous"></script>

</head>

<body>
  <div id="formContainer">
    <form id="myForm">
      Test Test Test
      <label for="name">Name:</label><br>
      <input type="text" id="name" name="name"><br>
      <!-- <label for="name">Phone Number:</label><br>
      <input type="number" id="phoneNumber" name="phoneNumber"><br> -->
      <label for="email">Email:</label><br>
      <input type="email" id="email" name="email"><br>
      <!-- <label for="name">House Number:</label><br>
      <input type="text" id="houseNumber" name="houseNumber"><br> -->
      <input type="submit" value="Submit">
    </form>
  </div>
</body>

</html>